<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ajouter des Ventes - CHNDLM S.A - Pharma</title>
    <link rel="stylesheet" href="css/dashstyle.css">
</head>

<body>
    <header>
        <h1>Ajouter des Ventes - CHNDLM S.A - Pharma</h1>
        <div class="header-buttons">
            <a href="dashboard.html" id="sales-button" class="header-btn"> Tableau de bord</a>
            <a href="jesyon.html" id="sales-button" class="header-btn">Gestion des Ventes</a>
            <a href="estimation.html" id="sales-button" class="header-btn">Estimation totale des stocks</a>
            <a href="perime.html" id="sales-button" class="header-btn">Médicaments Périmés</a>
            <a href="notif.html" id="sales-button" class="header-btn">Quantités insuffisantes</a>
            <a href="report.html" id="sales-button" class="header-btn">Rapports de ventes</a>
            <a href="sales.html" id="sales-button" class="header-btn">Ventes</a>
            <a href="index.html" id="logout-button" class="logout-btn">Déconnexion</a>
        </div>
    </header>

    <section id="add-sales-section">
        <h2>Ajouter une Nouvelle Vente</h2>
        <div class="form-group">
            <label for="sale-date">Date de Vente :</label>
            <input type="date" id="sale-date" required>
        </div>
        <div class="form-group">
            <label for="client-name">Nom du Client :</label>
            <input type="text" id="client-name" required>
        </div>
        <div class="form-group">
            <label for="medication-name">Nom du Médicament :</label>
            <input type="text" id="medication-name" required>
        </div>
        <div class="form-group">
            <label for="category">Catégorie du Médicament :</label>
            <select id="category" required>
                <option value="">Filtrer par Catégorie</option>
                <option value="Analgésique">Analgésique (Soulagement de la douleur)</option>
                <option value="Anxiolytique">Anxiolytique</option>
                <option value="Antibiotique">Antibiotique</option>
                <option value="Anticonvulsivant">Anticonvulsivant</option>
                <option value="Antidiabétique">Antidiabétique</option>
                <option value="Antihistaminique">Antihistaminique</option>
                <option value="Antimicrobien">Antimicrobien</option>
                <option value="Antipyretique">Antipyretique (Soulagement de la fièvre)</option>
                <option value="Antiseptique">Antiseptique</option>
                <option value="Antiviral">Antiviral</option>
                <option value="Corticostéroïde">Corticostéroïde</option>
                <option value="Crème">Crème</option>
                <option value="Dentifrice">Dentifrice</option>
                <option value="Diurétique">Diurétique</option>
                <option value="Laxatif">Laxatif</option>
                <option value="Probiotique">Probiotique</option>
                <option value="Sédatif">Sédatif</option>
                <option value="Vasodilatateur">Vasodilatateur</option>
                <option value="Antifongique">Antifongique</option>
                <option value="Vitamines">Vitamines</option>
                <option value="Minéraux">Minéraux</option>
                <option value="Anti-inflammatoire">Anti-inflammatoire</option>
                <option value="Supplément">Supplément</option>
                <option value="Hormonale">Hormonale</option>
                <option value="Anticoagulant">Anticoagulant</option>
                <option value="Antiallergique">Antiallergique</option>
                <option value="Antiémétique">Antiémétique</option>
                <option value="Nutraceutique">Nutraceutique</option>
                <option value="Astringent">Astringent</option>
                <option value="Bronchodilatateur">Bronchodilatateur</option>
                <option value="Calmant">Calmant</option>
                <option value="Chimiothérapie">Chimiothérapie</option>
                <option value="Décongestionnant">Décongestionnant</option>
                <option value="Détoxifiant">Détoxifiant</option>
                <option value="Dopaminergique">Dopaminergique</option>
                <option value="Endocrinien">Endocrinien</option>
                <option value="Enzymatique">Enzymatique</option>
                <option value="Hépatoprotecteur">Hépatoprotecteur</option>
                <option value="Immunostimulant">Immunostimulant</option>
                <option value="Hypnotique">Hypnotique</option>
                <option value="Hypoglycémiant">Hypoglycémiant</option>
                <option value="Lipolytique">Lipolytique</option>
                <option value="Narcotique">Narcotique</option>
                <option value="Neuroprotecteur">Neuroprotecteur</option>
                <option value="Opiacé">Opiacé</option>
                <option value="Oxygénateur">Oxygénateur</option>
                <option value="Pancréatique">Pancréatique</option>
                <option value="Relaxant musculaire">Relaxant musculaire</option>
                <option value="Thérapeutique">Thérapeutique</option>
                <option value="Vasoprotecteur">Vasoprotecteur</option>
                <option value="autres">Autres</option>
            </select>
        </div>
        <div class="form-group">
            <label for="quantity">Quantité :</label>
            <input type="number" id="quantity" min="1" required>
        </div>
        <div class="form-group">
            <label for="unit-price">Prix Unitaire (GDES) :</label>
            <input type="number" id="unit-price" min="1" required>
        </div>
        <button id="add-sale-button" class="header-btn">Ajouter Vente</button>

        <h3>Historique des Ventes</h3>
        <table id="sales-history-table" class="sales-table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Client</th>
                    <th>Médicament</th>
                    <th>Catégorie</th>
                    <th>Quantité</th>
                    <th>Prix Unitaire (GDES)</th>
                    <th>Prix Total (GDES)</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const salesHistory = JSON.parse(localStorage.getItem('salesHistory')) || [];

            const salesTableBody = document.querySelector('#sales-history-table tbody');
            const saleDateInput = document.getElementById('sale-date');
            const clientNameInput = document.getElementById('client-name');
            const medicationNameInput = document.getElementById('medication-name');
            const categoryInput = document.getElementById('category');
            const quantityInput = document.getElementById('quantity');
            const unitPriceInput = document.getElementById('unit-price');
            const addSaleButton = document.getElementById('add-sale-button');

            const renderTable = () => {
                salesTableBody.innerHTML = '';

                if (salesHistory.length === 0) {
                    salesTableBody.innerHTML = '<tr><td colspan="7" style="text-align: center;">Aucune vente enregistrée</td></tr>';
                    return;
                }

                salesHistory.forEach((sale) => {
                    const totalSalePrice = sale.quantity * sale.price;

                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${sale.date}</td>
                        <td>${sale.clientName}</td>
                        <td>${sale.medication}</td>
                        <td>${sale.category}</td>
                        <td>${sale.quantity}</td>
                        <td>${sale.price}</td>
                        <td>${totalSalePrice.toFixed(2)}</td>
                    `;
                    salesTableBody.appendChild(row);
                });
            };

            const addSale = () => {
                const saleDate = saleDateInput.value;
                const clientName = clientNameInput.value;
                const medicationName = medicationNameInput.value;
                const category = categoryInput.value;
                const quantity = parseInt(quantityInput.value, 10);
                const price = parseFloat(unitPriceInput.value);

                if (!saleDate || !clientName || !medicationName || !category || !quantity || !price) {
                    alert('Veuillez remplir tous les champs avant d\'ajouter la vente.');
                    return;
                }

                const newSale = {
                    date: saleDate,
                    clientName: clientName,
                    medication: medicationName,
                    category: category,
                    quantity: quantity,
                    price: price
                };

                salesHistory.push(newSale);
                localStorage.setItem('salesHistory', JSON.stringify(salesHistory));

                // Clear the form inputs
                saleDateInput.value = '';
                clientNameInput.value = '';
                medicationNameInput.value = '';
                categoryInput.value = '';
                quantityInput.value = '';
                unitPriceInput.value = '';

                renderTable();
            };

            addSaleButton.addEventListener('click', addSale);

            // Initial render of sales history
            renderTable();
        });
    </script>
</body>

</html>
